<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>.:: Login ::.</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
          rel="stylesheet">
    <style>
        html, body { font-family: "Roboto", system-ui, -apple-system, "Segoe UI", "Helvetica Neue", Arial, sans-serif; font-weight: 300; font-optical-sizing: auto; font-style: normal; }
        #username::placeholder, #password::placeholder {
            color: #bfbfbf;
            opacity: 1;
        }
    </style>
</head>

<body class="flex items-center justify-center min-h-screen py-16 lg:py-10 bg-slate-50 dark:bg-zink-800 dark:text-zink-100 font-public">

<div class="account-pages my-5 pt-sm-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6 col-xl-5">
                <div class="card overflow-hidden">
                    <div class="bg-primary-subtle">
                        <div class="row">
                            <div class="col-7">
                                <div class="text-primary p-4">
                                    <h5 class="text-primary">Welcome Back !</h5>
                                    <p>Sign in to continue.</p>
                                </div>
                            </div>
                            <div class="col-5 align-self-end">
                                <img th:src="@{/assets/images/profile-img.png}" alt="" class="img-fluid">
                            </div>
                        </div>
                    </div>

                    <div class="card-body pt-0">
                        <div>
                            <a routerLink="/">
                                <div class="avatar-md profile-user-wid mb-4">
                  <span class="avatar-title rounded-circle bg-light">
                    <img th:src="@{/assets/images/logo.svg}" class="rounded-circle" height="34" alt="">
                  </span>
                                </div>
                            </a>
                        </div>

                        <div class="p-2">

                            <!-- Mensaje de error proveniente del Model (persistirá tras refresh) -->
                            <div th:if="${errorMessage}" class="alert alert-danger mb-3 text-center"
                                 th:text="${errorMessage}"></div>

                            <!-- (Opcional) Si mantienes logout con ?logout -->
                            <div th:if="${param.logout}" class="alert alert-success mb-3 text-center">
                                Sesión cerrada correctamente.
                            </div>

                            <form class="form-horizontal needs-validation" method="post" th:action="@{/login}"
                                  novalidate>
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                                <div class="mb-3">
                                    <label for="username">Email</label>
                                    <input type="email" class="form-control" id="username" name="username"
                                           placeholder="ejemplo@correo.com" required autofocus/>
                                    <div class="invalid-feedback">Por favor ingrese un email válido.</div>
                                </div>

                                <div class="mb-3">
                                    <label for="password">Password:</label>
                                    <div class="input-group auth-pass-inputgroup">
                                        <input type="password" class="form-control" id="password" name="password"
                                               placeholder="********" required/>
                                        <div class="invalid-feedback">Por favor ingrese su contraseña.</div>
                                    </div>
                                </div>

                                <div class="mt-3 d-grid">
                                    <button class="btn btn-primary" type="submit">Log In</button>
                                </div>
                            </form>
                        </div>

                    </div>
                </div>

                <div class="mt-5 text-center">
                    <p>Don't have an account ? <a th:href="@{/register}" class="fw-medium text-primary"> Signup now</a>
                    </p>
                    <p>© 2025. created for <i class="mdi mdi-heart text-danger"></i> nexaplaform </p>
                </div>

            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>

<!-- (Opcional) Auto-ocultar alertas tras 4s -->
<script>
    setTimeout(() => {
      document.querySelectorAll('.alert').forEach(a => a.classList.add('d-none'));
    }, 4000);

    // Validación personalizada de Bootstrap
    (() => {
      'use strict';
      const forms = document.querySelectorAll('.needs-validation');

      Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    })();
</script>
</body>
</html>
